<!--Comment-->
<!DOCTYPE html>
<html lang="en">
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="/style.css"> 

<title>Map Generator</title>
<h1>Map Generator</h1>

<form>
<label for=players>players:</label>
<select id="players" name="players">
  <option value="2">2</option>
  <option value="4">4</option>
</select>
<input type=submit>
</form>

<table>
<tr>
<td><img name =a1 alt=desert src=desert.png id=player41></td>
<td><img name =a1 alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png id=player33></td>
<td><img alt=desert src=desert.png id=player42></td>
</tr>
<tr>
<td><img alt=desert src=desert.png id=player31></td>
<td><img alt=desert src=desert.png id=player21></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
</tr>
<tr>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png id=player22></td>
<td><img alt=desert src=desert.png></td>
</tr>
<tr>
<td><img alt=desert src=desert.png id=player43></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png id=player32></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png></td>
<td><img alt=desert src=desert.png id=player44></td>
</tr>
</table>

<p id =difficulty> the difficulty of this generated map is </p>
<p>Copy this layout with the physical tiles. Then <a href=event.html>go to event generator</a>.</p>
<button onclick="changeTerrain()">Get Sandy</button>
<button onclick="createTable()">Build Map</button>

<script>
window.onload = function(event) {
	difficulty = 24;
	const cells = Array.from(document.getElementsByTagName("img")); //heb er een array van gemaakt.
    
	for (const cell of cells) {  
		if (Math.random() > 0.5) {		
			cell.src = "forest.png";
			cell.alt = "forest";
			difficulty-= 1;
		}
		
	}
	
	
	console.log(cells);
		console.log(cells[0]["alt"]);


 
 //zo makkelijk gaat het niet: //count(cells.alt == forest)
 //de hard way als alt accessable zou zijn binnen value... //const difficulty = cells.filter(value["alt"] => value.["alt"] === "forest").length; //https://stackoverflow.com/questions/38375646/filtering-array-of-objects-with-arrays-based-on-nested-value
 document.getElementById("difficulty").innerHTML +=Math.round(( (difficulty*100/24))) + "%";
	
	const urlParams = new URLSearchParams(window.location.search);
	const players = urlParams.get('players'); 
	if (players == 2) {
		player1 = document.getElementById("player21")
		player2 = document.getElementById("player22")

		player1.src = player2.src = "city.png"
		player1.alt = player2.alt = "city"
	}
	if (players == 3) {
		player1 = document.getElementById("player31")
		player2 = document.getElementById("player32")
		player3 = document.getElementById("player33")
	}
	if (players == 4) {
		player1 = document.getElementById("player41")
		player2 = document.getElementById("player42")
		player3 = document.getElementById("player43")
		player4 = document.getElementById("player44")
		
		player1.src = player2.src = player3.src = player4.src = "city.png"
		player1.alt = player2.alt = player3.src = player4.src = "city"
		
	}
	player1.src = player2.src = "city.png"
	player1.alt = player2.alt = "city"
	player3.src = player4.src = "city.png"
	player3.alt = player4.alt = "city"
	
	
};
</script>
<script>
 function changeTerrain(){
	//logica om zand->bos en andersom te simuleren
	//omliggende horizontale en verticale velden zijn: west cell[-4] noord cell[-1] oost cell[+4] zuid cell[+1]
	
const table = document.getElementById('gameMap')
console.log(table)
const arr = [...table.rows].map(r => [...r.querySelectorAll('td')].map(td => td.innerHTML)) 
console.log(arr)

//to array or not to array, setAttribute lijkt in beide gevallen niet te werken
const mapCells = Array.from(document.getElementsByClassName("imgMC")); //mapCell moet dan nog naar img.alt kunnen kijken - hoe van td element naar cell.getElementsByTagName("img")
console.log("dit is const array mapcells", mapCells)
for (var i = 0, cell; cell = mapCells[i]; i++) {
console.log("dit is mapcell[i]", mapCells[i]['drought'])
console.log("dit is cell ",cell['drought'])
if(Math.random()>.2 && mapCells[i-1]['drought'] == 1 && mapCells[i+1]['drought'] == 1 ){
cell.src = 'desert.png'
}
//cell.setAttribute('drought', 1) //zo'n new attribute is blijkbaar niet accessible via console.log, want geeft hierna undefined terug. 
cell.drought = 1 //direct nieuwe waarde introduceren en setten gaat zonder problemen en komt ook goed terug in console.log
console.log("dit is cell buiten loop ",cell['drought'])
console.log(cell.alt)
console.log(cell.drought)

}
/*var table = document.getElementById("gameMap");
for (var i = 0, row; row = table.rows[i]; i++) {
   //iterate through rows
   //rows would be accessed using the "row" variable assigned in the for loop
   for (var j = 0, col; col = row.cells[j]; j++) {
   console.log(col.innerHTML);
  
     //iterate through columns
     //columns would be accessed using the "col" variable assigned in the for loop
   }  
}

	//for (var i = 0; i < cells.length; ++i){
	//console.log(cells[i+1]["alt"]);
	
	//}
	*/
	};
 

	function createTable() {
	var map_width = 12;
	var map_heigth = 8;
  const body = document.body,
        tbl = document.createElement('table');
		tbl.id = "gameMap"
  //tbl.style.width = '500px';
  //tbl.style.height = '500px';
  // tbl.style.padding = '5px'; //welke setting geeft deze white space om velden en welke waarde heb jij gebruikt?

  //tbl.style.border = '1px solid black';

//counter om cell nummerID te geven
var cell_id = 0;
var img = document.createElement('img');
    img.src = "desert.png";
	img.alt = "desert"
	img.setAttribute('drought', 1)
	
  for (let i = 0; i < map_heigth; i++) {
    const tr = tbl.insertRow();
    for (let j = 0; j < map_width; j++) {
 
        const td = tr.insertCell();
		
		td.setAttribute('class', "mapCell" ) //counter cell_id=+1??
		td.drought = 0
     //   td.appendChild(document.createTextNode(`Cell I${i}/J${j}`));
		//td.appendChild(img)
		if (0 < i  && i < (map_heigth-1) && 0 < j && j < (map_width-1)) { // 0 < i < 5 is blijkbaar geen JS-syntax
		//if (i != 0 && i != 5 && j != 0 && j!= 7){
		td.drought = 1
		td.innerHTML="<img src='desert.png' alt='desert' class='imgMC'/>"
			if (Math.random() > 0.5) {		
				td.innerHTML="<img src='forest.png' alt='forest' class='imgMC'/>"
				td.drought = 0
				}
			if (i==Math.floor(map_heigth/2) && j==Math.floor(map_width/2)){ td.innerHTML = "<img src='city.png' alt='city' class='imgMC'/>" }
		// console.log("hiero "+ td.getElementsByTagName("img")) //td.['img'] td.img geeft undefined
		
		// td.appendChild(document.createTextNode(`Cell I${i}/J${j}`));
		
		} 
    
        }
		// assign city tile. Dit moet achteraf,  anders heb je bias van probabality of dat city tile uiteindelijk nergens komt?
	//	Math.floor(Math.random() * (max - min) + min); // The maximum is exclusive and the minimum is inclusive
      }

  body.appendChild(tbl);
}

createTable();	

</script>

<!--
End comments
